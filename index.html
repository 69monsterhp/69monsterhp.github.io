<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Manager</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; background-color: #f4f4f4; }
        .container { width: 50%; margin: 0 auto; padding: 20px; background-color: white; border-radius: 8px; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1); }
        h1, h2 { text-align: center; }
        form { display: flex; flex-direction: column; margin-bottom: 20px; }
        input { padding: 10px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 4px; }
        button { padding: 10px; background-color: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background-color: #218838; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 10px; border: 1px solid #ddd; }
        th { background-color: #f8f9fa; }
        .hidden { display: none; }
        .actions { text-align: center; }
        .actions button { margin: 0 5px; }
    </style>
</head>
<body>

    <!-- Login Page -->
    <div id="loginPage" class="container">
        <h1>Login</h1>
        <form id="loginForm">
            <input type="text" id="loginUsername" placeholder="Username" required>
            <input type="password" id="loginPassword" placeholder="Password" required>
            <button type="submit">Login</button>
        </form>
        <p>Don't have an account? <a href="javascript:void(0);" onclick="showRegisterPage()">Register here</a></p>
    </div>

    <!-- Register Page -->
    <div id="registerPage" class="container hidden">
        <h1>Register</h1>
        <form id="registerForm">
            <input type="text" id="registerUsername" placeholder="Username" required>
            <input type="password" id="registerPassword" placeholder="Password" required>
            <button type="submit">Register</button>
        </form>
        <p>Already have an account? <a href="javascript:void(0);" onclick="showLoginPage()">Login here</a></p>
    </div>

    <!-- Password Manager Page -->
    <div id="passwordManagerPage" class="container hidden">
        <h1>Password Manager</h1>
        <button onclick="logout()">Logout</button>
        <form id="passwordForm">
            <input type="text" id="website" placeholder="Website" required>
            <input type="text" id="username" placeholder="Username" required>
            <input type="password" id="password" placeholder="Password" required>
            <button type="submit">Save</button>
        </form>
        <h2>Stored Passwords</h2>
        <table id="passwordsTable">
            <thead>
                <tr>
                    <th>Website</th>
                    <th>Username</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <!-- Passwords will be dynamically inserted here -->
            </tbody>
        </table>
    </div>

    <script>
        // Simulate the "database" using localStorage
        let users = JSON.parse(localStorage.getItem("users")) || [];
        let loggedInUser = JSON.parse(localStorage.getItem("loggedInUser")) || null;
        let passwords = JSON.parse(localStorage.getItem("passwords")) || [];

        // Show login page
        function showLoginPage() {
            document.getElementById("loginPage").classList.remove("hidden");
            document.getElementById("registerPage").classList.add("hidden");
            document.getElementById("passwordManagerPage").classList.add("hidden");
        }

        // Show register page
        function showRegisterPage() {
            document.getElementById("registerPage").classList.remove("hidden");
            document.getElementById("loginPage").classList.add("hidden");
        }

        // Show password manager page
        function showPasswordManagerPage() {
            document.getElementById("passwordManagerPage").classList.remove("hidden");
            document.getElementById("loginPage").classList.add("hidden");
            document.getElementById("registerPage").classList.add("hidden");
            displayPasswords();
        }

        // Display stored passwords in the table
        function displayPasswords() {
            const tableBody = document.getElementById("passwordsTable").getElementsByTagName("tbody")[0];
            tableBody.innerHTML = ""; // Clear current table rows

            passwords.forEach((password, index) => {
                const row = tableBody.insertRow();
                row.insertCell(0).innerText = password.website;
                row.insertCell(1).innerText = password.username;

                const actionsCell = row.insertCell(2);
                actionsCell.classList.add("actions");

                // Add delete, edit, and copy buttons
                actionsCell.innerHTML = `
                    <button onclick="editPassword(${index})">Edit</button>
                    <button onclick="deletePassword(${index})">Delete</button>
                    <button onclick="copyPassword(${index})">Copy</button>
                `;
            });
        }

        // Register new user
        document.getElementById("registerForm").addEventListener("submit", function(e) {
            e.preventDefault();
            const username = document.getElementById("registerUsername").value;
            const password = document.getElementById("registerPassword").value;

            // Check if username already exists
            if (users.some(user => user.username === username)) {
                alert("Username already exists!");
                return;
            }

            // Hash password (for demonstration, using plain text)
            users.push({ username, password });
            localStorage.setItem("users", JSON.stringify(users));
            alert("Registration successful! Please login.");
            showLoginPage();
        });

        // Login user
        document.getElementById("loginForm").addEventListener("submit", function(e) {
            e.preventDefault();
            const username = document.getElementById("loginUsername").value;
            const password = document.getElementById("loginPassword").value;

            const user = users.find(user => user.username === username && user.password === password);
            if (user) {
                loggedInUser = user;
                localStorage.setItem("loggedInUser", JSON.stringify(loggedInUser));
                showPasswordManagerPage();
            } else {
                alert("Invalid credentials. Please try again.");
            }
        });

        // Logout user
        function logout() {
            loggedInUser = null;
            localStorage.removeItem("loggedInUser");
            showLoginPage();
        }

        // Save password
        document.getElementById("passwordForm").addEventListener("submit", function(e) {
            e.preventDefault();
            if (!loggedInUser) {
                alert("You must be logged in to add a password.");
                return;
            }

            const website = document.getElementById("website").value;
            const username = document.getElementById("username").value;
            const password = document.getElementById("password").value;

            passwords.push({ website, username, password });
            localStorage.setItem("passwords", JSON.stringify(passwords));
            displayPasswords();
        });

        // Edit password
        function editPassword(index) {
            const newWebsite = prompt("Enter new website:", passwords[index].website);
            const newUsername = prompt("Enter new username:", passwords[index].username);
            const newPassword = prompt("Enter new password:", passwords[index].password);

            if (newWebsite && newUsername && newPassword) {
                passwords[index] = { website: newWebsite, username: newUsername, password: newPassword };
                localStorage.setItem("passwords", JSON.stringify(passwords));
                displayPasswords();
            }
        }

        // Delete password
        function deletePassword(index) {
            const confirmDelete = confirm("Are you sure you want to delete this password?");
            if (confirmDelete) {
                passwords.splice(index, 1);
                localStorage.setItem("passwords", JSON.stringify(passwords));
                displayPasswords();
            }
        }

        // Copy password to clipboard
        function copyPassword(index) {
            const passwordToCopy = passwords[index].password;
            navigator.clipboard.writeText(passwordToCopy)
                .then(() => alert("Password copied to clipboard!"))
                .catch(err => alert("Error copying password: " + err));
        }

        // Initial page setup
        if (loggedInUser) {
            showPasswordManagerPage();
        } else {
            showLoginPage();
        }
    </script>

</body>
</html>
